<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pustaka Materi</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        /* Sembunyikan Scrollbar tapi tetap bisa scroll */
        .hide-scroll::-webkit-scrollbar { display: none; }
        .hide-scroll { -ms-overflow-style: none; scrollbar-width: none; }
    </style>
</head>
<body class="bg-gray-50 font-sans pb-10">

    <!-- Container Mobile -->
    <div class="max-w-md mx-auto bg-white min-h-screen shadow-2xl overflow-hidden relative">
        
        <!-- HEADER -->
        <div class="bg-gradient-to-br from-blue-900 to-gray-900 p-5 rounded-b-3xl shadow-lg relative z-10">
            <div class="flex items-center gap-3 mb-6">
                <!-- Logo -->
                <img src="https://imgur.com/5Srjyo4.png" alt="Logo" class="w-12 h-12 object-cover rounded-full border-2 border-yellow-400 shadow-md">
                <div>
                    <h1 class="text-yellow-400 font-extrabold text-xl tracking-wider uppercase">Pustaka Materi</h1>
                    <p class="text-blue-200 text-xs">Belajar & Berkarya Tanpa Batas</p>
                </div>
            </div>

            <!-- Stats Info -->
            <div class="flex justify-around bg-white/10 backdrop-blur-sm rounded-xl p-3 text-center border border-white/10">
                <div>
                    <h3 class="text-white font-bold text-xl" id="count-karya">0</h3>
                    <p class="text-gray-300 text-xs uppercase">Karya</p>
                </div>
                <div class="w-px bg-gray-500/50"></div>
                <div>
                    <h3 class="text-white font-bold text-xl" id="count-materi">0</h3>
                    <p class="text-gray-300 text-xs uppercase">Materi</p>
                </div>
            </div>
        </div>

        <!-- SECTION 1: KARYA -->
        <div class="mt-8 pl-5">
            <div class="flex justify-between items-end pr-5 mb-4">
                <h2 class="text-blue-900 font-bold text-lg border-l-4 border-yellow-400 pl-2">Karya Terbaru</h2>
                <a href="list-karya.html" class="text-xs text-gray-500 hover:text-blue-600 font-semibold">Lihat Semua <i class="fas fa-chevron-right text-[10px]"></i></a>
            </div>

            <!-- Horizontal Scroll Container -->
            <div id="container-karya" class="flex overflow-x-auto hide-scroll gap-4 pb-4 pr-5 snap-x">
                <!-- Skeleton Loading -->
                <div class="min-w-[140px] h-[220px] bg-gray-200 rounded-xl animate-pulse"></div>
                <div class="min-w-[140px] h-[220px] bg-gray-200 rounded-xl animate-pulse"></div>
            </div>
        </div>

        <!-- SECTION 2: MATERI -->
        <div class="mt-6 pl-5">
            <div class="flex justify-between items-end pr-5 mb-4">
                <h2 class="text-blue-900 font-bold text-lg border-l-4 border-yellow-400 pl-2">Materi Pilihan</h2>
                <a href="list-materi.html" class="text-xs text-gray-500 hover:text-blue-600 font-semibold">Lihat Semua <i class="fas fa-chevron-right text-[10px]"></i></a>
            </div>

            <!-- Horizontal Scroll Container -->
            <div id="container-materi" class="flex overflow-x-auto hide-scroll gap-4 pb-4 pr-5 snap-x">
                <!-- Skeleton Loading -->
                <div class="min-w-[140px] h-[220px] bg-gray-200 rounded-xl animate-pulse"></div>
                <div class="min-w-[140px] h-[220px] bg-gray-200 rounded-xl animate-pulse"></div>
            </div>
        </div>

    </div>

    <!-- SCRIPT UTAMA -->
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const db = JSON.parse(localStorage.getItem('pustaka_db')) || [];
            
            // Filter Data
            const dataKarya = db.filter(item => item.kategori === 'karya');
            const dataMateri = db.filter(item => item.kategori === 'materi');

            // Update Stats
            document.getElementById('count-karya').innerText = dataKarya.length;
            document.getElementById('count-materi').innerText = dataMateri.length;

            // Render Function (Limit 10 untuk Home)
            function renderScroll(data, containerId) {
                const container = document.getElementById(containerId);
                container.innerHTML = '';

                if(data.length === 0) {
                    container.innerHTML = '<p class="text-sm text-gray-400 italic pr-5">Belum ada konten.</p>';
                    return;
                }

                // Ambil 10 teratas
                data.slice(0, 10).forEach(item => {
                    const card = `
                        <div class="min-w-[140px] w-[140px] snap-start flex flex-col group">
                            <div class="relative h-[200px] rounded-xl overflow-hidden shadow-md mb-3 bg-gray-200">
                                <img src="${item.cover}" alt="${item.judul}" class="w-full h-full object-cover group-hover:scale-110 transition duration-500">
                                <div class="absolute inset-0 bg-gradient-to-t from-black/60 to-transparent opacity-0 group-hover:opacity-100 transition-opacity"></div>
                            </div>
                            <h3 class="text-gray-800 font-bold text-sm leading-tight line-clamp-2 mb-2 h-10">${item.judul}</h3>
                            <a href="${item.link}" target="_self" class="bg-blue-900 text-yellow-400 text-xs font-bold py-2 px-3 rounded-lg text-center hover:bg-blue-800 transition shadow-sm">
                                <i class="fas fa-download mr-1"></i> UNDUH
                            </a>
                        </div>
                    `;
                    container.innerHTML += card;
                });

                // Tambah tombol "Lihat Semua" di ujung scroll jika data > 10
                if(data.length > 10) {
                    const moreLink = containerId === 'container-karya' ? 'list-karya.html' : 'list-materi.html';
                    container.innerHTML += `
                        <a href="${moreLink}" class="min-w-[100px] flex flex-col items-center justify-center text-blue-900 snap-start">
                            <div class="w-12 h-12 rounded-full bg-blue-100 flex items-center justify-center mb-2">
                                <i class="fas fa-arrow-right"></i>
                            </div>
                            <span class="text-xs font-bold">Lihat Semua</span>
                        </a>
                    `;
                }
            }

            renderScroll(dataKarya, 'container-karya');
            renderScroll(dataMateri, 'container-materi');
        });
    </script>
</body>
</html>
